# AeroSpace configuration (macOS tiling WM)
# Goal: Hyprland-like, keyboard-driven workflow
#
# SUPER is implemented as macOS Command (Cmd).
# NOTE: Cmd is heavily used by macOS/apps; some bindings may conflict or be
# swallowed by apps/system shortcuts. If that happens, either choose different
# keys or reintroduce a dedicated modifier via Karabiner.
#
# Workspaces 3-5 use Cmd+Caps Lock instead of Cmd+Shift to avoid macOS screenshot conflicts
# Caps Lock alone sends Escape (configured in Karabiner, useful for vim/terminal)

start-at-login = true

# Launch JankyBorders with AeroSpace
after-startup-command = [
    'exec-and-forget borders'
]

default-root-container-layout = "tiles"
default-root-container-orientation = "auto"

enable-normalization-flatten-containers = true
enable-normalization-opposite-orientation-for-nested-containers = true

on-focused-monitor-changed = ["move-mouse monitor-lazy-center"]

[gaps]
inner.horizontal = 12
inner.vertical = 12
outer.left = 12
outer.bottom = 12
outer.top = 12  # Sketchybar lives in menu bar area, just need gap
outer.right = 12

[mode.main.binding]
# Focus (arrow keys)
cmd-left = "focus left"
cmd-down = "focus down"
cmd-up = "focus up"
cmd-right = "focus right"

# Workspace switching (1-9)
cmd-1 = "workspace 1"
cmd-2 = "workspace 2"
cmd-3 = "workspace 3"
cmd-4 = "workspace 4"
cmd-5 = "workspace 5"
cmd-6 = "workspace 6"
cmd-7 = "workspace 7"
cmd-8 = "workspace 8"
cmd-9 = "workspace 9"

# Move window (Hyprland: SUPER+SHIFT+arrows)
cmd-shift-left = "move left"
cmd-shift-down = "move down"
cmd-shift-up = "move up"
cmd-shift-right = "move right"

# Send window to workspace (Hyprland: SUPER+SHIFT+[1-9])
# Note: Workspaces 3-5 use Cmd+Ctrl (mapped from Cmd+Caps Lock via Karabiner) to avoid macOS screenshot conflicts
cmd-shift-1 = "move-node-to-workspace 1"
cmd-shift-2 = "move-node-to-workspace 2"
cmd-ctrl-3 = "move-node-to-workspace 3"
cmd-ctrl-4 = "move-node-to-workspace 4"
cmd-ctrl-5 = "move-node-to-workspace 5"
cmd-shift-6 = "move-node-to-workspace 6"
cmd-shift-7 = "move-node-to-workspace 7"
cmd-shift-8 = "move-node-to-workspace 8"
cmd-shift-9 = "move-node-to-workspace 9"

# Window actions
cmd-f = "fullscreen"
# Toggle split direction for the current container (Hyprland-style togglesplit)
cmd-j = "layout tiles horizontal vertical"

# App launcher basics (kept minimal; expand later)
cmd-enter = "exec-and-forget open -na Ghostty"

# Toggle floating for current window
cmd-shift-space = "layout floating tiling"

# Move workspace to monitor (Hyprland: SUPER+CTRL+arrows)
cmd-ctrl-left = "move-workspace-to-monitor --wrap-around prev"
cmd-ctrl-right = "move-workspace-to-monitor --wrap-around next"

# Focus monitor directly (Hyprland: SUPER+comma/period)
cmd-alt-left = "focus-monitor --wrap-around prev"
cmd-alt-right = "focus-monitor --wrap-around next"

# Move window to monitor (send window without moving workspace)
cmd-alt-shift-left = "move-node-to-monitor --wrap-around prev"
cmd-alt-shift-right = "move-node-to-monitor --wrap-around next"

# =============================================================================
# Floating window rules
# =============================================================================
# Apps that should always float (not tiled)

[[on-window-detected]]
if.app-id = "com.1password.1password"
run = "layout floating"

[[on-window-detected]]
if.app-id = "com.apple.systempreferences"
run = "layout floating"

[[on-window-detected]]
if.app-id = "com.apple.calculator"
run = "layout floating"

# Finder dialogs (Save As, Open, etc.)
[[on-window-detected]]
if.app-id = "com.apple.finder"
run = "layout floating"
