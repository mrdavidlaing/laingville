# Claude Code Settings

This directory contains Claude Code configuration for mrdavidlaing.

## Files

- `settings.json` - **Machine-specific** (not in git, generated by setup-user)
- `settings.template.json` - Cross-platform template (assumes bash in PATH)
- `settings.windows.json` - Windows-specific template with PATH overrides
- `commands/` - Custom slash commands (committed to git)
- `scripts/` - Helper scripts like bash-direnv-wrapper (committed to git)
- `wrappers/` - Command wrappers (committed to git)

## Platform-Specific Setup

### Mac/Linux
Uses `settings.template.json` as-is. Bash is always in PATH.

### Windows
Two options:

1. **If bash is in system PATH** (e.g., via Scoop, Git for Windows):
   - Use `settings.template.json`
   - Hook commands work cross-platform

2. **If bash is NOT in system PATH**:
   - Use `settings.windows.json` as template
   - Replace `{{USERNAME}}` with actual username
   - Adds bash to PATH via env.PATH setting

## Hook Commands

All hook commands use `bash` prefix for cross-platform compatibility:

```json
"command": "bash ~/.local/bin/claude-code-bash-direnv-wrapper"
```

This works when:
- Mac/Linux: bash always in PATH
- Windows: bash in system PATH or added via env.PATH

## Setup

The `generate-settings.sh` script automatically:
1. Detects platform (Windows/Mac/Linux)
2. Generates settings from appropriate template to temp file
3. Replaces `{{USERNAME}}` with current user
4. If `~/.claude/settings.json` doesn't exist: creates it
5. If `~/.claude/settings.json` exists: shows diff instead of overwriting

The script is called automatically by `setup-user` via `setup-user-hook.sh`.

## Manual Setup

### First Time Setup
Run the generation script:

```bash
# From any platform (Mac/Linux/Git Bash on Windows)
./dotfiles/mrdavidlaing/.claude/generate-settings.sh
```

This will:
- Create `~/.claude/settings.json` from template
- Use the cross-platform template by default
- Use Windows-specific template if bash is not in PATH

### Updating Settings

If you update the templates, run the script again to see differences:

```bash
./dotfiles/mrdavidlaing/.claude/generate-settings.sh
```

It will:
- Show a diff if your settings differ from the template
- Preserve your existing settings (won't overwrite)
- Provide instructions to force update if desired

To force regenerate from template:
```bash
rm ~/.claude/settings.json
./dotfiles/mrdavidlaing/.claude/generate-settings.sh
```
