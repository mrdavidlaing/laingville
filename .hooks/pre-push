#!/bin/bash
# Pre-push hook for Laingville repository
# Syncs beads, then runs all tests before allowing push

set -e

# Run beads pre-push hook first if bd is available
if command -v bd >/dev/null 2>&1; then
    echo "ğŸ”„ Running beads pre-push sync..."
    bd hooks run pre-push "$@"
    echo
fi

echo "ğŸš€ Running pre-push checks..."
echo

# Run all checks and tests
echo "ğŸ”§ Running all checks and tests (just)..."
if ! just; then
    echo
    echo "âŒ Checks failed. Push aborted."
    echo "ğŸ’¡ Fix the issues above, or use 'git push --no-verify' to skip this hook."
    exit 1
fi

echo
echo "âœ… All pre-push checks passed! Proceeding with push..."
