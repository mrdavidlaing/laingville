{"id":"LV-100","title":"macOS: make AeroSpace keybinds match Hyprland SUPER/SHIFT layers","description":"Change Karabiner CapsLock mapping so it does NOT include Shift, enabling Hyprland-style SUPER vs SUPER+SHIFT bindings. Update AeroSpace config so bindings match Hyprland muscle memory (SUPER+hjkl focus, SUPER+1-9 workspace, SUPER+SHIFT+hjkl move window, SUPER+SHIFT+1-9 send window).","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-14T11:33:12.882158Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-1y0","title":"Create devcontainer for yolo agent execution","description":"Create a devcontainer optimized for AI/ML agent execution (like Claude Code) with maximum permissions within the container boundary.\n\n## Goals\n- Give agents full freedom inside the container (passwordless sudo, all tools available)\n- Contain blast radius to the container only\n- Pre-install all language runtimes (Python, Node.js, Go, Rust, Bash) so agents don't need to request installations\n- Mount only the current Git repository (isolated from rest of host)\n- Forward SSH agent for Git push operations\n\n## Design Principles\n- Maximum permissions WITHIN container\n- Strict isolation FROM host system\n- Permission requests only for cross-container-boundary access\n- If something goes wrong, damage limited to container\n\n## Technical Approach\n- Add yolo-agent-devcontainer image definition to infra/flake.nix\n- Combine all language runtime package sets\n- Use mkDevContainer builder with all dev tools\n- Create .devcontainer/yolo-agent/ with devcontainer.json and docker-compose.yml\n- Add validation tests to infra/tests/\n- Update CI workflow to build multi-arch images","notes":"## Implementation Complete ✅\n\n### Final Approach\nReplaced the default  configuration with yolo-agent setup instead of creating a separate devcontainer directory. This provides a simpler, unified experience.\n\n### All Changes\n\n**1. Updated .devcontainer/ configuration:**\n- ✅ .devcontainer/devcontainer.json - Added all language runtime extensions (Python, Node.js, Go, Rust)\n- ✅ .devcontainer/docker-compose.yml - Updated mount path to /workspace, added security comments\n- ✅ Workspace now mounts to /workspace instead of /workspaces/laingville\n\n**2. Updated infra/flake.nix:**\n- ✅ Replaced laingville-devcontainer definition with yolo-agent setup\n- ✅ Now includes ALL language runtimes and dev tools: Python, Node.js, Go, Rust, Bash\n- ✅ Keeps same image name: ghcr.io/mrdavidlaing/laingville/laingville-devcontainer\n\n**3. Created comprehensive test suite:**\n- ✅ infra/tests/test-yolo-agent-environment.sh (350+ lines)\n- ✅ Tests all language runtimes (Python, Node.js, Go, Rust, Bash)\n- ✅ Validates dev tools, passwordless sudo, environment configuration\n- ✅ Made executable with proper permissions\n\n**4. Updated CI/CD workflow:**\n- ✅ Updated .github/workflows/build-containers.yml\n- ✅ laingville-devcontainer now runs yolo-agent environment tests\n- ✅ Multi-arch builds (amd64 + arm64) continue to work\n- ✅ Removed separate yolo-agent-devcontainer from build matrix\n\n**5. Updated documentation:**\n- ✅ Updated infra/README.md with yolo-agent design philosophy\n- ✅ Documented single devcontainer approach\n- ✅ Provided usage examples for VS Code and Claude Code CLI\n- ✅ Listed host access permissions clearly\n\n### Files Changed\n- .devcontainer/devcontainer.json (modified)\n- .devcontainer/docker-compose.yml (modified)\n- infra/flake.nix (modified)\n- infra/tests/test-yolo-agent-environment.sh (created)\n- .github/workflows/build-containers.yml (modified)\n- infra/README.md (modified)\n\n### Ready for Deployment\nAll code complete and ready to commit. When pushed to main, CI will build the new multi-arch image with all language runtimes.","status":"closed","priority":2,"issue_type":"feature","owner":"david@davidlaing.com","created_at":"2026-01-11T10:42:21.27261Z","created_by":"David Laing","updated_at":"2026-01-11T11:02:48.82551Z","closed_at":"2026-01-11T11:02:48.82551Z","close_reason":"Implementation complete and pushed to main. CI will build multi-arch yolo-agent devcontainer image."}
{"id":"LV-25u","title":"macOS: always remove ~/.local/bin/bd when brew bd installed","description":"Change cleanup_old_beads_install to always delete ~/.local/bin/bd whenever Homebrew steveyegge/beads/bd is installed (single source of truth in /opt/homebrew/bin).","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-14T13:01:30.370321Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-2i5","title":"Create base config with agent definitions","description":"Create ~/.config/opencode/oh-my-opencode.json with agent-to-category mappings.\n\n## Acceptance Criteria\n- Base config exists at ~/.config/opencode/oh-my-opencode.json\n- Contains all 7 agent definitions using categories (not models)\n- Includes schema reference and google_auth setting\n\n## Config Structure\n```json\n{\n  \"$schema\": \"https://raw.githubusercontent.com/code-yeongyu/oh-my-opencode/master/assets/oh-my-opencode.schema.json\",\n  \"google_auth\": false,\n  \"agents\": {\n    \"Sisyphus\": {\"category\": \"quick\"},\n    \"oracle\": {\"category\": \"most-capable\"},\n    \"librarian\": {\"category\": \"quick\"},\n    \"explore\": {\"category\": \"quick\"},\n    \"frontend-ui-ux-engineer\": {\"category\": \"visual-engineering\"},\n    \"document-writer\": {\"category\": \"writing\"},\n    \"multimodal-looker\": {\"category\": \"quick\"}\n  }\n}\n```\n\n## Notes\n- This is one-time setup\n- No categories section needed yet (profiles will add that)\n- Keep existing google_auth and other settings if config already exists","status":"closed","priority":0,"issue_type":"task","owner":"david@davidlaing.com","created_at":"2026-01-11T11:20:07.972181Z","created_by":"David Laing","updated_at":"2026-01-11T12:24:07.310022Z","closed_at":"2026-01-11T12:24:07.310022Z","close_reason":"Converted ~/.config/opencode/oh-my-opencode.json from model-based to category-based format. Added back missing Sisyphus and explore agents. All 7 agents now use category assignments (not model assignments). Base config is ready for profile merging."}
{"id":"LV-2vl","title":"macOS: use Cmd as SUPER for AeroSpace","description":"Switch AeroSpace bindings to use Cmd-only as the SUPER modifier (Cmd+hjkl focus, Cmd+1-9 workspace, Cmd+Shift+hjkl move, Cmd+Shift+1-9 send). Remove Karabiner dependency for the core workflow.","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-14T11:37:52.320118Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-2yf","title":"Add devcontainer helper scripts and just targets","description":"Add convenience helpers for managing the laingville devcontainer, inspired by training-batch-java patterns.\n\nComponents to add:\n1. .devcontainer/bin/ctl script (up/down/shell/status commands)\n2. Just targets for devcontainer management\n3. Credential injection (GitHub via gh CLI)\n4. Consider nix-vscode-compat feature if VS Code issues arise\n\nBenefits:\n- Easy lifecycle management (start/stop/access container)\n- Automatic credential forwarding\n- Consistent developer experience\n- Better integration with existing just workflows","notes":"## Implementation Complete ✅\n\n### What was implemented:\n\n**1. Control Script (.devcontainer/bin/ctl)**\n- Created shell script for devcontainer lifecycle management\n- Commands: up, down, shell, status\n- Automatic GitHub credential extraction from macOS keychain\n- Shows scopes being handed to agent at startup\n\n**2. Just Targets**\n- Added 5 new devcontainer management targets to justfile\n- just dev-up: Start devcontainer with GitHub credentials\n- just dev-down: Stop devcontainer\n- just dev-shell: Open interactive shell in running container\n- just dev-status: Show service health\n- just dev-rebuild: Pull latest image and restart\n\n**3. GitHub Credential Forwarding (Option 2)**\n- Mounts ~/.config/gh read-only (preserves aliases and preferences)\n- Extracts GITHUB_TOKEN from host keychain via ctl script\n- Displays account and scopes when starting container\n- Shows agent capabilities and blast radius\n\n**4. Documentation**\n- Updated infra/README.md with GitHub credentials section\n- Added just command examples to usage section\n- Documented scopes and security model\n\n### Files changed:\n- .devcontainer/bin/ctl (created, 200+ lines)\n- .devcontainer/docker-compose.yml (added gh config mount + GITHUB_TOKEN)\n- justfile (added devcontainer section with 5 targets)\n- infra/README.md (documented GitHub credentials and just commands)\n\n### Credential forwarding details:\n- Token scopes forwarded: repo, read:org, read:packages, gist\n- Config mount: ~/.config/gh (read-only)\n- Security: Blast radius limited to container + GitHub API\n- User sees exactly what's being handed to agent at startup","status":"closed","priority":2,"issue_type":"task","owner":"david@davidlaing.com","created_at":"2026-01-11T11:06:29.506746Z","created_by":"David Laing","updated_at":"2026-01-11T11:40:42.460586Z","closed_at":"2026-01-11T11:40:42.460586Z","close_reason":"Implementation complete. Devcontainer helpers provide easy lifecycle management with GitHub credential forwarding."}
{"id":"LV-8b2","title":"macOS: add Cmd+F AeroSpace fullscreen","description":"Add Cmd+F binding in AeroSpace config to toggle fullscreen (Hyprland-style SUPER+F).","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-14T11:46:30.622322Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-8k0","title":"macOS: cleanup old ~/.local/bin/bd artifacts","description":"Add a macOS setup-user custom script to remove legacy bd installs (e.g. ~/.local/bin/bd from old go/curl installer) when Homebrew bd is installed, preventing PATH shadowing.","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-14T12:53:13.091595Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-8lc","title":"macOS: Cmd+Enter always opens new Ghostty","description":"Change AeroSpace cmd+enter binding to always open a new Ghostty (use 'open -na Ghostty' so it doesn't just focus an existing window).","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-14T12:03:57.01794Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-8rj","title":"macOS: make Cmd+J toggle container split orientation","description":"Change Cmd+J to toggle the focused container layout between horizontal and vertical (AeroSpace layout toggle) so it behaves like Hyprland/Omarchy togglesplit affecting the focused window + its neighbor(s), without using the split command.","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-14T12:23:27.519874Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-8vv","title":"Configure opencode","status":"closed","priority":2,"issue_type":"feature","owner":"david@davidlaing.com","created_at":"2026-01-11T10:07:58.347695Z","created_by":"David Laing","updated_at":"2026-01-24T13:41:39.575816594Z","closed_at":"2026-01-24T13:41:39.575822221Z","dependencies":[{"issue_id":"LV-8vv","depends_on_id":"LV-9dr","type":"blocks","created_at":"2026-01-11T10:08:27.754196Z","created_by":"David Laing"}]}
{"id":"LV-97x","title":"Fix perles installation by using custom binary installer","status":"closed","priority":2,"issue_type":"task","owner":"david@davidlaing.com","created_at":"2026-01-24T12:58:47.447737073Z","created_by":"David Laing","updated_at":"2026-01-24T12:58:50.974123864Z","closed_at":"2026-01-24T12:58:50.974123864Z","close_reason":"Fixed perles installation by creating a custom script to download GitHub releases, as it's missing from AUR"}
{"id":"LV-9dr","title":"Configure oh-my-opencode","status":"open","priority":2,"issue_type":"task","owner":"david@davidlaing.com","created_at":"2026-01-11T10:08:06.819504Z","created_by":"David Laing","updated_at":"2026-01-11T10:08:06.819504Z","dependencies":[{"issue_id":"LV-9dr","depends_on_id":"LV-w8e","type":"blocks","created_at":"2026-01-11T10:36:36.040619Z","created_by":"David Laing"}]}
{"id":"LV-aao","title":"Update setup-user for omo-profiles symlink","description":"Add symlink creation in setup-user for omo-profiles directory.\n\n## Acceptance Criteria\n- setup-user creates symlink: ~/.config/opencode/omo-profiles → dotfiles/shared/.config/opencode/omo-profiles/\n- Symlink created automatically on setup-user run\n- Works cross-platform (Linux/macOS/WSL)\n- Directory created if doesn't exist\n\n## Implementation Location\nAdd to dotfiles symlink processing in setup-user script where .config/opencode/ is handled.\n\n## Symlink Creation\n```bash\n# In setup-user, add to .config/opencode/ handling\nSOURCE=\"$DOTFILES_DIR/.config/opencode/omo-profiles\"\nTARGET=\"$HOME/.config/opencode/omo-profiles\"\n\nif [[ -e \"$SOURCE\" ]]; then\n  mkdir -p \"$(dirname \"$TARGET\")\"\n  \n  # Remove existing symlink or directory\n  if [[ -L \"$TARGET\" ]]; then\n    rm \"$TARGET\"\n  elif [[ -d \"$TARGET\" ]]; then\n    echo \"Warning: $TARGET exists and is not a symlink\"\n    # Optionally backup and replace\n  fi\n  \n  # Create symlink\n  ln -s \"$SOURCE\" \"$TARGET\"\n  echo \"Created symlink: $TARGET -\u003e $SOURCE\"\nfi\n```\n\n## Testing\n```bash\n# Run setup-user\n./setup-user\n\n# Verify symlink created\nls -la ~/.config/opencode/omo-profiles\n\n# Should show: omo-profiles -\u003e /path/to/dotfiles/shared/.config/opencode/omo-profiles\n\n# Verify profiles accessible\nls ~/.config/opencode/omo-profiles/*.json\n```\n\n## Notes\n- omo-profile script already expects profiles at ~/.config/opencode/omo-profiles\n- This symlink makes them available there\n- Editing files in dotfiles will be immediately visible","status":"closed","priority":0,"issue_type":"task","owner":"david@davidlaing.com","created_at":"2026-01-11T11:20:52.009099Z","created_by":"David Laing","updated_at":"2026-01-24T13:11:35.660176791Z","closed_at":"2026-01-24T13:11:35.660176791Z","close_reason":"Added omo-profiles symlink logic to setup-user-hook.sh and updated symlinks.yaml","dependencies":[{"issue_id":"LV-aao","depends_on_id":"LV-l7g","type":"blocks","created_at":"2026-01-11T11:21:25.258703Z","created_by":"David Laing"}]}
{"id":"LV-bub","title":"Update omo-profile script merge behavior","description":"Modify omo-profile script to merge categories only, preserving agents and other config sections.\n\n## Acceptance Criteria\n- switch_profile() merges categories instead of copying entire file\n- get_current_profile() compares categories instead of agents\n- PROFILES_DIR updated to ~/.config/opencode/omo-profiles\n- Script preserves agents, google_auth, and all other sections\n\n## Code Changes\n\n**Update PROFILES_DIR (line 21):**\n```bash\nPROFILES_DIR=\"$HOME/.config/opencode/omo-profiles\"\n```\n\n**Update switch_profile() function (~line 104-148):**\n```bash\nswitch_profile() {\n  local profile=\"$1\"\n  local profile_file=\"$PROFILES_DIR/$profile.json\"\n  local backup_file=\"$TARGET_FILE.backup\"\n\n  if [[ \\! -f \"$profile_file\" ]]; then\n    echo -e \"${RED}Error: Profile '$profile' not found${NC}\" \u003e\u00262\n    exit 1\n  fi\n\n  mkdir -p \"$OPENCODE_CONFIG_DIR\"\n\n  # Backup existing config\n  if [[ -f \"$TARGET_FILE\" ]]; then\n    cp \"$TARGET_FILE\" \"$backup_file\"\n  fi\n\n  # Merge categories only\n  if [[ -f \"$TARGET_FILE\" ]]; then\n    current_config=$(cat \"$TARGET_FILE\")\n    profile_categories=$(jq '.categories' \"$profile_file\")\n    merged_config=$(echo \"$current_config\" | jq --argjson cats \"$profile_categories\" '.categories = $cats')\n    echo \"$merged_config\" | jq '.' \u003e \"$TARGET_FILE\"\n  else\n    # First time - just copy (no base config exists yet)\n    cp \"$profile_file\" \"$TARGET_FILE\"\n  fi\n\n  echo -e \"${GREEN}Switched to '$profile' profile${NC}\"\n  echo \"\"\n  echo \"Category model assignments:\"\n  jq -r '.categories | to_entries[] | \"  \\(.key): \\(.value.model)\"' \"$profile_file\"\n\n  # Show diff if backup exists\n  if [[ -f \"$backup_file\" ]]; then\n    echo \"\"\n    echo -e \"${BLUE}Changes from previous config:${NC}\"\n    if diff -q \"$backup_file\" \"$TARGET_FILE\" \u003e /dev/null 2\u003e\u00261; then\n      echo \"  (no changes)\"\n    else\n      diff --color=always -u \"$backup_file\" \"$TARGET_FILE\" | tail -n +3\n    fi\n  fi\n}\n```\n\n**Update get_current_profile() function (~line 76-102):**\n```bash\nget_current_profile() {\n  if [[ \\! -f \"$TARGET_FILE\" ]]; then\n    echo \"(none)\"\n    return\n  fi\n\n  # Compare .categories section instead of .agents\n  local current_categories\n  current_categories=$(jq -cS '.categories // {}' \"$TARGET_FILE\" 2\u003e/dev/null) || {\n    echo \"(invalid json)\"\n    return\n  }\n\n  for profile_file in \"$PROFILES_DIR\"/*.json; do\n    if [[ -f \"$profile_file\" ]]; then\n      local profile_categories\n      profile_categories=$(jq -cS '.categories // {}' \"$profile_file\" 2\u003e/dev/null) || continue\n      if [[ \"$current_categories\" == \"$profile_categories\" ]]; then\n        basename \"$profile_file\" .json\n        return\n      fi\n    fi\n  done\n\n  echo \"(custom config)\"\n}\n```\n\n## Testing During Development\nTest merge preserves agents:\n```bash\n# Before switch\njq '.agents' ~/.config/opencode/oh-my-opencode.json\n\n# Switch profile\nomo-profile performance\n\n# After switch - agents should still be there\njq '.agents' ~/.config/opencode/oh-my-opencode.json\n```","status":"closed","priority":0,"issue_type":"task","owner":"david@davidlaing.com","created_at":"2026-01-11T11:20:39.741001Z","created_by":"David Laing","updated_at":"2026-01-11T12:31:15.727911Z","closed_at":"2026-01-11T12:31:15.727911Z","close_reason":"Updated omo-profile script to merge categories only while preserving agents and other config sections. Updated PROFILES_DIR path to omo-profiles. Updated get_current_profile() to compare categories. Updated help text for new profile structure. Script now prevents migration bug by avoiding agent-based configs.","dependencies":[{"issue_id":"LV-bub","depends_on_id":"LV-l7g","type":"blocks","created_at":"2026-01-11T11:21:25.166002Z","created_by":"David Laing"}]}
{"id":"LV-c699","title":"Fix CI failures present on 1 Nov 2025","description":"Multiple CI test failures are preventing the build from passing. These failures are unrelated to recent code changes and appear to be pre-existing issues that need to be resolved.\n\nContext:\n- All failures observed in GitHub Actions runs on 2025-11-01\n- Failures span multiple platforms: Windows, macOS, and Arch Linux\n- The Nix-based tests are passing successfully\n\nImpact:\n- CI pipeline is failing on every push\n- Blocks confident merging of PRs\n- Prevents automated quality checks from completing","acceptance_criteria":"- [ ] All CI jobs pass on main branch\n- [ ] PowerShell linting completes without errors\n- [ ] PowerShell formatting tests pass on all platforms\n- [ ] No test failures in GitHub Actions workflow","status":"tombstone","priority":1,"issue_type":"epic","created_at":"2025-11-01T19:48:13.183234077Z","updated_at":"2026-01-11T09:47:06.506525Z","labels":["ci","infrastructure","testing"],"deleted_at":"2026-01-11T09:47:06.506525Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"epic"}
{"id":"LV-c699.1","title":"Fix PowerShell linting errors (PSScriptAnalyzer)","description":"The PowerShell linting job is failing with 'make lint' Error 1 on Windows runners.\n\nObserved in:\n- Run 18995053910 (commit 907280d)\n- Run 18996459153 (latest)\n\nError:\n```\nmake: *** [Makefile:30: lint] Error 1\n##[error]Process completed with exit code 2.\n```\n\nThis is blocking the entire CI pipeline on Windows. The linting step must pass before tests can run.\n\nInvestigation needed:\n1. Determine which PowerShell file(s) are failing linting\n2. Identify the specific PSScriptAnalyzer rule violations\n3. Fix the violations or update linting rules if appropriate","acceptance_criteria":"- [ ] PowerShell linting completes without errors on Windows runners\n- [ ] 'make lint' exits with code 0\n- [ ] All PSScriptAnalyzer warnings are resolved or suppressed appropriately","status":"tombstone","priority":0,"issue_type":"bug","created_at":"2025-11-01T19:48:28.793288646Z","updated_at":"2026-01-11T09:47:06.506525Z","labels":["ci","linting","powershell","windows"],"deleted_at":"2026-01-11T09:47:06.506525Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"LV-c699.2","title":"Fix PowerShell CRLF line ending format tests","description":"Multiple ShellSpec tests are failing related to CRLF line ending handling for PowerShell files on macOS and Arch Linux.\n\nFailing tests:\n1. `spec/format_line_endings_spec.sh:94` - converts PowerShell files with LF to CRLF\n2. `spec/format_line_endings_spec.sh:113` - maintains CRLF line endings in PowerShell files\n3. `spec/format_line_endings_spec.sh:132` - normalizes mixed line endings in PowerShell files to CRLF\n\nRoot cause:\nThe format-files.sh script is not properly converting or preserving CRLF (Windows-style) line endings for PowerShell files when running on Unix-based systems (macOS, Linux).\n\nImpact:\n- 6 test failures across macOS and Arch Linux runners\n- Exit code 101 on both platforms\n- These tests were confirmed pre-existing (failing since at least Oct 23)\n\nThis is lower priority than the linting errors but still needs to be fixed for CI to pass.","acceptance_criteria":"- [ ] All line ending tests pass on macOS runner\n- [ ] All line ending tests pass on Arch Linux runner\n- [ ] PowerShell files maintain CRLF line endings after formatting\n- [ ] Mixed line endings are properly normalized to CRLF","status":"tombstone","priority":1,"issue_type":"bug","created_at":"2025-11-01T19:48:45.547308274Z","updated_at":"2026-01-11T09:47:06.506525Z","labels":["ci","line-endings","linux","macos","powershell","testing"],"deleted_at":"2026-01-11T09:47:06.506525Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"LV-c699.3","title":"Fix PowerShell trailing whitespace/newline format tests","description":"ShellSpec tests are failing related to trailing whitespace and newline handling for PowerShell files on macOS and Arch Linux.\n\nFailing tests:\n1. `spec/format_whitespace_spec.sh:63` - adds trailing CRLF to PowerShell file that lacks one\n2. `spec/format_whitespace_spec.sh:82` - reduces multiple blank lines at end to single CRLF for PowerShell\n3. `spec/format_whitespace_spec.sh:135` - removes trailing spaces from PowerShell files while preserving CRLF\n\nRoot cause:\nThe format-files.sh script's trailing whitespace and newline normalization logic is not working correctly for PowerShell files on Unix systems, particularly when it needs to preserve or add CRLF line endings.\n\nImpact:\n- 6 test failures across macOS and Arch Linux runners\n- May be related to the CRLF line ending issues (LV-c699.2)\n- Could potentially be fixed together with line ending issues\n\nNote: This bead may have dependency on LV-c699.2 if the root cause is shared.","acceptance_criteria":"- [ ] Trailing CRLF tests pass on macOS runner\n- [ ] Trailing CRLF tests pass on Arch Linux runner  \n- [ ] Trailing whitespace is removed while preserving CRLF\n- [ ] Multiple blank lines are normalized to single CRLF","status":"tombstone","priority":1,"issue_type":"bug","created_at":"2025-11-01T19:48:56.745838674Z","updated_at":"2026-01-11T09:47:06.506525Z","labels":["ci","linux","macos","powershell","testing","whitespace"],"dependencies":[{"issue_id":"LV-c699.3","depends_on_id":"LV-c699.2","type":"blocks","created_at":"2025-11-01T19:48:56.811093384Z","created_by":"mrdavidlaing","metadata":"{}"}],"deleted_at":"2026-01-11T09:47:06.506525Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"LV-d80","title":"macOS: Phase 3 dotfiles migration + AeroSpace/Karabiner MVP","description":"Implement Phase 3 macOS dotfiles migration changes per docs/plans/2025-12-13-dotfiles-devcontainer-separation-design.md, and add minimal AeroSpace + Karabiner-Elements configuration for Hyprland-like tiling workflow (HYPER key + workspace/window navigation).","status":"tombstone","priority":1,"issue_type":"feature","created_at":"2025-12-14T11:26:07.857816Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"feature"}
{"id":"LV-f76d","title":"Fix Arch Linux CI container missing 'make' package","description":"The Arch Linux CI container is failing with 'make: command not found' error.\n\nObserved in CI run 19003311597:\n- Platform: Arch Linux (archlinux:latest container on ubuntu-latest runner)\n- Step: Check formatting and lint\n- Error: /__w/_temp/d10dc99c-fa54-4418-ba05-e8b059bf591f.sh: line 15: make: command not found\n- Exit code: 127\n\nRoot cause:\nThe Arch Linux container doesn't have 'make' installed by default. This became visible after recent CI changes that started using 'make lint' command.\n\nImpact:\n- Blocks all Arch Linux CI tests\n- Prevents linting and testing from running\n- Only platform currently failing in CI\n\nInvestigation needed:\n1. Check .github/workflows CI configuration for Arch Linux container setup\n2. Determine where system dependencies are installed\n3. Add 'make' to the package list for Arch container","acceptance_criteria":"- [ ] Arch Linux CI container has 'make' installed\n- [ ] 'make lint' runs successfully in Arch container\n- [ ] All Arch Linux CI tests pass\n- [ ] No exit code 127 errors","status":"tombstone","priority":0,"issue_type":"bug","created_at":"2025-11-01T22:12:56.853043969Z","updated_at":"2026-01-11T09:47:06.506525Z","labels":["archlinux","ci","container","infrastructure"],"deleted_at":"2026-01-11T09:47:06.506525Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"LV-gp1","title":"macOS: add SUPER+J split-direction toggle (AeroSpace)","description":"Add Hyprland-equivalent SUPER+J binding on macOS (Cmd+J) to toggle the tiling split orientation in AeroSpace.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-14T12:12:42.215939Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-gs0","title":"macOS: restore beads installation changes","description":"Restore beads installation work that was reverted while isolating the AeroSpace commit: add Homebrew tap support in macOS Brewfile generation, update tests, and switch to installing bd via brew tap instead of the curl-based install script (where applicable).","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-14T12:30:22.098304Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-j7w","title":"WSL: xdg-open not found - configure wslview as browser opener","description":"## Problem\n\nWhen running beads-bridge serve on WSL, the browser auto-open fails with:\n```\n/bin/sh: line 1: xdg-open: command not found\n```\n\nThis happens because WSL doesn't have xdg-open by default, which is the standard Linux command to open URLs in the default browser.\n\n## Solution\n\nInstall wslu (WSL Utilities) which provides wslview - a tool that opens URLs in the Windows default browser.\n\n### Option 1: Install wslu package\n```bash\n# Ubuntu/Debian\nsudo apt install wslu\n\n# Then xdg-open alternative is available as:\nwslview http://example.com\n```\n\n### Option 2: Create xdg-open symlink/alias\nAfter installing wslu, create a symlink so xdg-open calls work:\n```bash\nsudo ln -s /usr/bin/wslview /usr/local/bin/xdg-open\n```\n\nOr add an alias to .bashrc:\n```bash\nalias xdg-open='wslview'\n```\n\n### Option 3: Set BROWSER environment variable\nSome tools check BROWSER before xdg-open:\n```bash\nexport BROWSER=wslview\n```\n\n## Verification\nAfter fix, this should open Windows browser:\n```bash\nxdg-open https://google.com\n# or\nwslview https://google.com\n```\n\n## Context\nDiscovered while running `just serve-bridge wms-rfg` in wellmaintained-skills repo on WSL.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-28T11:40:51.771961515Z","updated_at":"2025-11-28T11:40:51.771961515Z"}
{"id":"LV-kl4","title":"Test profile switching and verify stability","description":"Comprehensive testing of omo-profile with category-based profiles to verify migration bug is fixed.\n\n## Acceptance Criteria\n- Profile switching changes categories only\n- Agent definitions preserved across switches\n- No config corruption on opencode execution\n- Profile detection works correctly\n- Stable state achieved (no infinite restore cycle)\n\n## Test Sequence\n\n### 1. Initial State Verification\n```bash\n# Check base config exists with agents\ncat ~/.config/opencode/oh-my-opencode.json | jq '.agents'\n\n# Should show all 7 agents with categories\n```\n\n### 2. Profile Switch Test\n```bash\n# Switch to value profile\nomo-profile value\n\n# Verify categories changed\ncat ~/.config/opencode/oh-my-opencode.json | jq '.categories'\n# Should show haiku/gpt-5-nano models\n\n# Verify agents preserved\ncat ~/.config/opencode/oh-my-opencode.json | jq '.agents'\n# Should still show all 7 agents\n\n# Verify current profile detected\nomo-profile\n# Should show: Current profile: value\n```\n\n### 3. Migration Bug Test (Critical)\n```bash\n# Run opencode to trigger migration\nopencode run \"ping\"\n\n# Wait for completion (up to 60s)\n\n# Check config still intact\ncat ~/.config/opencode/oh-my-opencode.json | jq '.agents'\n# Should still have Sisyphus and explore (NOT deleted)\n\n# Run profile command again\nomo-profile value\n\n# Should show \"(no changes)\" - NOT restoring configs\n```\n\n### 4. Multiple Switch Test\n```bash\n# Switch between profiles\nomo-profile performance\nomo-profile value\nomo-profile free\n\n# Each switch should:\n# - Change categories\n# - Preserve agents\n# - Be detected correctly by omo-profile command\n```\n\n### 5. Stability Test\n```bash\n# Switch to value\nomo-profile value\n\n# Run opencode multiple times\nopencode run \"ping\"\nopencode run \"ping\"\n\n# Profile should remain stable\nomo-profile value\n# Should show \"(no changes)\" both times\n```\n\n## Success Criteria\n✅ Categories change on profile switch\n✅ Agents never deleted or modified\n✅ google_auth and other settings preserved\n✅ Profile detection accurate\n✅ No corruption after opencode execution\n✅ No restore cycle (stable state)\n\n## Failure Indicators\n❌ Sisyphus or explore agents missing after opencode run\n❌ omo-profile shows \"Changes from previous config\" when switching to same profile twice\n❌ Agents section modified unexpectedly\n❌ Profile detection shows wrong profile\n\n## Rollback Plan\nIf tests fail:\n1. Backup current oh-my-opencode.json\n2. Restore old profile files\n3. Restore old omo-profile script\n4. Document failure mode for debugging","status":"closed","priority":0,"issue_type":"task","owner":"david@davidlaing.com","created_at":"2026-01-11T11:21:11.115444Z","created_by":"David Laing","updated_at":"2026-01-24T13:11:38.60262511Z","closed_at":"2026-01-24T13:11:38.60262511Z","close_reason":"Verified profile switching and config stability","dependencies":[{"issue_id":"LV-kl4","depends_on_id":"LV-2i5","type":"blocks","created_at":"2026-01-11T11:21:25.347825Z","created_by":"David Laing"},{"issue_id":"LV-kl4","depends_on_id":"LV-l7g","type":"blocks","created_at":"2026-01-11T11:21:25.438603Z","created_by":"David Laing"},{"issue_id":"LV-kl4","depends_on_id":"LV-bub","type":"blocks","created_at":"2026-01-11T11:21:25.530068Z","created_by":"David Laing"},{"issue_id":"LV-kl4","depends_on_id":"LV-aao","type":"blocks","created_at":"2026-01-11T11:21:25.620934Z","created_by":"David Laing"}]}
{"id":"LV-l7g","title":"Rewrite profile files to categories-only format","description":"Move profiles from ~/.config/opencode/profiles/ to dotfiles repo and convert to categories-only format.\n\n## Acceptance Criteria\n- 3 profile files in dotfiles/shared/.config/opencode/omo-profiles/:\n  - free.json\n  - value.json\n  - performance.json\n- Each contains ONLY categories section (no agents, no google_auth)\n- Category model mappings correct for each profile\n\n## Profile Content\n\n**value.json:**\n```json\n{\n  \"categories\": {\n    \"quick\": {\"model\": \"anthropic/claude-haiku-4-5\"},\n    \"most-capable\": {\"model\": \"openai/gpt-5-nano\"},\n    \"visual-engineering\": {\"model\": \"google/gemini-3-flash\"},\n    \"writing\": {\"model\": \"google/gemini-3-flash\"}\n  }\n}\n```\n\n**performance.json:**\n```json\n{\n  \"categories\": {\n    \"quick\": {\"model\": \"anthropic/claude-sonnet-4-5\"},\n    \"most-capable\": {\"model\": \"anthropic/claude-opus-4-5\"},\n    \"visual-engineering\": {\"model\": \"google/gemini-3-pro\"},\n    \"writing\": {\"model\": \"google/gemini-3-flash\"}\n  }\n}\n```\n\n**free.json:**\n```json\n{\n  \"categories\": {\n    \"quick\": {\"model\": \"opencode/glm-4.7-free\"},\n    \"most-capable\": {\"model\": \"opencode/glm-4.7-free\"},\n    \"visual-engineering\": {\"model\": \"opencode/glm-4.7-free\"},\n    \"writing\": {\"model\": \"opencode/glm-4.7-free\"}\n  }\n}\n```\n\n## Steps\n1. Create dotfiles/shared/.config/opencode/omo-profiles/ directory\n2. Copy existing profiles and strip out agents/google_auth sections\n3. Keep only categories with model mappings\n4. Remove old ~/.config/opencode/profiles/ directory","status":"closed","priority":0,"issue_type":"task","owner":"david@davidlaing.com","created_at":"2026-01-11T11:20:19.584401Z","created_by":"David Laing","updated_at":"2026-01-11T12:03:32.225278Z","closed_at":"2026-01-11T12:03:32.225278Z","close_reason":"Created 3 profile files (free.json, value.json, performance.json) in dotfiles/shared/.config/opencode/omo-profiles/ with categories-only format. Each profile contains only category-to-model mappings, no agents or other config sections."}
{"id":"LV-m0z","title":"macOS: remove Rectangle persisted preferences","description":"Add a macOS-only setup-user custom step to remove Rectangle's persisted config (defaults domain and preference plist) so old Rectangle shortcuts/config don’t linger after migrating to AeroSpace.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-14T12:10:21.803608Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-m1z","title":"macOS: fix beads Homebrew formula name","description":"Homebrew tap steveyegge/beads succeeds but setup-user fails on macOS because Brewfile uses brew \"bd\" which may not resolve. Use fully-qualified formula steveyegge/beads/bd in packages.yaml and update tests accordingly.","status":"tombstone","priority":1,"issue_type":"bug","created_at":"2025-12-14T12:48:13.797098Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"LV-m3c","title":"macOS: remove Cmd+hjkl AeroSpace binds","description":"Remove Cmd+hjkl and Cmd+Shift+hjkl AeroSpace bindings; keep only Cmd+Arrow and Cmd+Shift+Arrow for focus/move to reduce conflicts.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-14T11:44:48.783254Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-m7x","title":"Fix: wire cleanup_old_beads_install to macOS","description":"cleanup_old_beads_install was mistakenly added under omarchy.custom; move it to macos.custom so it runs on macOS where ~/.local/bin/bd can shadow Homebrew bd.","status":"tombstone","priority":1,"issue_type":"bug","created_at":"2025-12-14T12:57:35.242344Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"LV-pio","title":"macOS: fix AeroSpace split vs normalization conflict","description":"AeroSpace config fails to parse because it uses the split command while enable-normalization-flatten-containers=true. Fix by disabling flatten-container normalization so cmd+j (split opposite) works (Hyprland-style SUPER+J).","status":"tombstone","priority":1,"issue_type":"bug","created_at":"2025-12-14T12:17:11.22088Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"LV-qcj","title":"Fix GHSA-5j98-mcp5-4vw2-glob (CVE-2025-64756) in nodejs","status":"open","priority":0,"issue_type":"chore","created_at":"2025-12-22T13:17:56.625177Z","updated_at":"2025-12-22T13:17:56.625177Z"}
{"id":"LV-qvf","title":"macOS: remove Rectangle from dotfiles","description":"Stop managing Rectangle window manager: remove its dotfiles/config from the repo and add cleanup so existing Rectangle symlink/config is removed on macOS.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-14T12:06:02.848458Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-upy","title":"macOS: disable Cmd+H and Cmd+M shortcuts","description":"Disable conflicting macOS shortcuts Cmd+H (Hide app) and Cmd+M (Minimize) using Karabiner so Cmd can be used as SUPER for AeroSpace without accidental hides/minimizes.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-14T11:48:46.076397Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-v65","title":"Packages: install beads via brew on macOS and yay on Arch","description":"Ensure beads (bd) is installed via Homebrew on macOS (steveyegge/beads tap + bd formula) and via yay on Arch (beads-git), removing any redundant custom install_beads step for those platforms.","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-14T12:34:08.840857Z","updated_at":"2026-01-24T11:07:19.426694617Z","deleted_at":"2026-01-24T11:07:19.426694617Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"LV-w8e","title":"Configure oh-my-opencode for omo-profile feature","description":"# omo-profile Category-Based Design\n\n**Date:** 2026-01-11\n**Issue:** LV-w8e - Configure oh-my-opencode for omo-profile feature\n**Status:** Design validated, ready for implementation\n\n## Problem Statement\n\noh-my-opencode v3 introduced automatic config migration that converts model-based agent configs to category-based configs. The migration logic:\n\n1. Converts `{\"model\": \"anthropic/claude-haiku-4-5\"}` → `{\"category\": \"quick\"}`\n2. Deletes agents that match category defaults (assumes they're redundant)\n\nThis breaks omo-profile because:\n- omo-profile writes explicit model configs\n- opencode startup triggers migration\n- Migration deletes Sisyphus and explore agents\n- omo-profile detects and restores them\n- Cycle repeats on every opencode execution\n\n**Root cause files:**\n- `src/plugin-config.ts:23` - Calls migration on every load\n- `src/shared/migration.ts:120-134` - Destructive deletion logic\n\n## Solution: Category-Based Profiles\n\nUse oh-my-opencode v3's native `categories` feature to override category-to-model mappings per profile.\n\n### Key Insight\n\noh-my-opencode v3 supports overriding category defaults in config:\n\n```json\n{\n  \"categories\": {\n    \"quick\": {\"model\": \"anthropic/claude-haiku-4-5\"},\n    \"most-capable\": {\"model\": \"anthropic/claude-opus-4-5\"}\n  }\n}\n```\n\nThis allows:\n- **Static agent-to-category mapping** (in base config)\n- **Dynamic category-to-model mapping** (per profile)\n- **No migration conflicts** (no explicit models in agents section)\n\n## Architecture\n\n### Profile Structure\n\nProfiles contain **only** category-to-model mappings:\n\n**value.json:**\n```json\n{\n  \"categories\": {\n    \"quick\": {\"model\": \"anthropic/claude-haiku-4-5\"},\n    \"most-capable\": {\"model\": \"openai/gpt-5-nano\"},\n    \"visual-engineering\": {\"model\": \"google/gemini-3-flash\"},\n    \"writing\": {\"model\": \"google/gemini-3-flash\"}\n  }\n}\n```\n\n**performance.json:**\n```json\n{\n  \"categories\": {\n    \"quick\": {\"model\": \"anthropic/claude-sonnet-4-5\"},\n    \"most-capable\": {\"model\": \"anthropic/claude-opus-4-5\"},\n    \"visual-engineering\": {\"model\": \"google/gemini-3-pro\"},\n    \"writing\": {\"model\": \"google/gemini-3-flash\"}\n  }\n}\n```\n\n**free.json:**\n```json\n{\n  \"categories\": {\n    \"quick\": {\"model\": \"opencode/glm-4.7-free\"},\n    \"most-capable\": {\"model\": \"opencode/glm-4.7-free\"},\n    \"visual-engineering\": {\"model\": \"opencode/glm-4.7-free\"},\n    \"writing\": {\"model\": \"opencode/glm-4.7-free\"}\n  }\n}\n```\n\n### Base Configuration\n\nBase config (`~/.config/opencode/oh-my-opencode.json`) contains agent definitions:\n\n```json\n{\n  \"$schema\": \"https://raw.githubusercontent.com/code-yeongyu/oh-my-opencode/master/assets/oh-my-opencode.schema.json\",\n  \"google_auth\": false,\n  \"agents\": {\n    \"Sisyphus\": {\"category\": \"quick\"},\n    \"oracle\": {\"category\": \"most-capable\"},\n    \"librarian\": {\"category\": \"quick\"},\n    \"explore\": {\"category\": \"quick\"},\n    \"frontend-ui-ux-engineer\": {\"category\": \"visual-engineering\"},\n    \"document-writer\": {\"category\": \"writing\"},\n    \"multimodal-looker\": {\"category\": \"quick\"}\n  },\n  \"categories\": {\n    \"quick\": {\"model\": \"anthropic/claude-haiku-4-5\"}\n  }\n}\n```\n\n## omo-profile Behavior\n\n### Current Behavior (Broken)\n- Copies entire profile → `oh-my-opencode.json` (overwrites everything)\n- Compares `.agents` section to detect profile\n- Migration corrupts agents on next opencode run\n\n### New Behavior (Fixed)\n- Reads current `oh-my-opencode.json`\n- **Merges** `categories` from profile into existing config\n- Preserves `agents`, `google_auth`, and all other sections\n- Compares `.categories` section to detect profile\n\n### Example Flow\n\n**Before:** `omo-profile value` (initial state)\n```json\n{\n  \"agents\": {\"Sisyphus\": {\"category\": \"quick\"}},\n  \"google_auth\": false,\n  \"categories\": {\n    \"quick\": {\"model\": \"anthropic/claude-sonnet-4-5\"}\n  }\n}\n```\n\n**Command:** `omo-profile performance`\n\n**After:** Categories replaced, agents preserved\n```json\n{\n  \"agents\": {\"Sisyphus\": {\"category\": \"quick\"}},\n  \"google_auth\": false,\n  \"categories\": {\n    \"quick\": {\"model\": \"anthropic/claude-opus-4-5\"}\n  }\n}\n```\n\n## File Locations\n\n### Repository Structure\n```\ndotfiles/shared/\n├── .config/opencode/omo-profiles/\n│   ├── free.json\n│   ├── value.json\n│   └── performance.json\n└── .local/bin/omo-profile\n```\n\n### Installed Structure (via setup-user)\n```\n~/.config/opencode/\n├── oh-my-opencode.json (base config)\n└── omo-profiles/ → symlink to ~/laingville/dotfiles/shared/.config/opencode/omo-profiles/\n    ├── free.json\n    ├── value.json\n    └── performance.json\n\n~/.local/bin/\n└── omo-profile → symlink to ~/laingville/dotfiles/shared/.local/bin/omo-profile\n```\n\n### omo-profile Script Paths\n```bash\nPROFILES_DIR=\"$HOME/.config/opencode/omo-profiles\"\nTARGET_FILE=\"$HOME/.config/opencode/oh-my-opencode.json\"\n```\n\n## Implementation Steps\n\n### 1. Create Base Config (One-Time Setup)\nCreate `~/.config/opencode/oh-my-opencode.json` with agent definitions:\n\n```json\n{\n  \"$schema\": \"https://raw.githubusercontent.com/code-yeongyu/oh-my-opencode/master/assets/oh-my-opencode.schema.json\",\n  \"google_auth\": false,\n  \"agents\": {\n    \"Sisyphus\": {\"category\": \"quick\"},\n    \"oracle\": {\"category\": \"most-capable\"},\n    \"librarian\": {\"category\": \"quick\"},\n    \"explore\": {\"category\": \"quick\"},\n    \"frontend-ui-ux-engineer\": {\"category\": \"visual-engineering\"},\n    \"document-writer\": {\"category\": \"writing\"},\n    \"multimodal-looker\": {\"category\": \"quick\"}\n  }\n}\n```\n\n### 2. Rewrite Profile Files\nMove existing profiles from `~/.config/opencode/profiles/` to repo:\n- Location: `dotfiles/shared/.config/opencode/omo-profiles/`\n- Remove `agents` section\n- Remove `google_auth` and other settings\n- Keep only `categories` with model mappings\n\n### 3. Update omo-profile Script\nModify `~/.local/bin/omo-profile`:\n\n**switch_profile() changes:**\n```bash\n# Old: Copy entire profile\ncp \"$profile_file\" \"$TARGET_FILE\"\n\n# New: Merge categories only\ncurrent_config=$(cat \"$TARGET_FILE\")\nprofile_categories=$(jq '.categories' \"$profile_file\")\nmerged_config=$(echo \"$current_config\" | jq --argjson cats \"$profile_categories\" '.categories = $cats')\necho \"$merged_config\" | jq '.' \u003e \"$TARGET_FILE\"\n```\n\n**get_current_profile() changes:**\n```bash\n# Old: Compare .agents section\ncurrent_agents=$(jq -cS '.agents // {}' \"$TARGET_FILE\")\n\n# New: Compare .categories section\ncurrent_categories=$(jq -cS '.categories // {}' \"$TARGET_FILE\")\n```\n\n### 4. Update setup-user\nAdd symlink creation for omo-profiles directory:\n\n```bash\n# In dotfiles/shared/.config/opencode/\nomo-profiles/ → symlink to ~/.config/opencode/omo-profiles/\n```\n\n### 5. Testing\n1. Run `omo-profile value`\n2. Verify categories changed in oh-my-opencode.json\n3. Verify agents section preserved\n4. Run `opencode run \"ping\"`\n5. Verify no agent configs deleted\n6. Run `omo-profile value` again\n7. Verify no \"Changes from previous config\" (stable state)\n\n## Migration Benefits\n\n**Before (broken):**\n- omo-profile writes: `{\"model\": \"anthropic/claude-haiku-4-5\"}`\n- Migration converts: `{\"category\": \"quick\"}`\n- Migration deletes: (matches defaults)\n- Infinite corruption cycle\n\n**After (fixed):**\n- omo-profile writes: `{\"categories\": {\"quick\": {\"model\": \"...\"}}}`\n- Migration ignores: (no agents with explicit models)\n- No deletion, no corruption\n- Stable state achieved\n\n## Future Extensions\n\nThis design supports future enhancements:\n\n1. **Per-profile agent mappings** (if needed later):\n   ```json\n   {\n     \"agents\": {\"Sisyphus\": {\"category\": \"quick\"}},\n     \"categories\": {\"quick\": {\"model\": \"...\"}}\n   }\n   ```\n\n2. **Project-specific profiles**:\n   - Project `.opencode/oh-my-opencode.json` can override categories\n   - omo-profile could support project-level profiles\n\n3. **Custom categories**:\n   - Add new categories beyond oh-my-opencode defaults\n   - Map to specific models per profile\n\n## References\n\n- Issue: LV-w8e (Configure oh-my-opencode for omo-profile feature)\n- Parent: LV-9dr (Configure oh-my-opencode)\n- Epic: LV-8vv (Configure opencode)\n- oh-my-opencode source: `/Users/mrdavidlaing/mo-inator-workspace/devcontainer-experiments/oh-my-opencode/`","status":"closed","priority":0,"issue_type":"task","owner":"david@davidlaing.com","created_at":"2026-01-11T10:08:37.367806Z","created_by":"David Laing","updated_at":"2026-01-24T13:11:38.678346011Z","closed_at":"2026-01-24T13:11:38.678346011Z","close_reason":"Completed category-based model resolution update","dependencies":[{"issue_id":"LV-w8e","depends_on_id":"LV-2i5","type":"blocks","created_at":"2026-01-11T11:21:16.891004Z","created_by":"David Laing"},{"issue_id":"LV-w8e","depends_on_id":"LV-l7g","type":"blocks","created_at":"2026-01-11T11:21:16.987942Z","created_by":"David Laing"},{"issue_id":"LV-w8e","depends_on_id":"LV-bub","type":"blocks","created_at":"2026-01-11T11:21:17.080139Z","created_by":"David Laing"},{"issue_id":"LV-w8e","depends_on_id":"LV-aao","type":"blocks","created_at":"2026-01-11T11:21:17.172238Z","created_by":"David Laing"},{"issue_id":"LV-w8e","depends_on_id":"LV-kl4","type":"blocks","created_at":"2026-01-11T11:21:17.262905Z","created_by":"David Laing"}]}
