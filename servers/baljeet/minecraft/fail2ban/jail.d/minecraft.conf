# Minecraft Server fail2ban Configuration
# Automatically bans IPs showing scanning or flood behavior

[minecraft-scanner]
# Detects TCP SYN scanning behavior on Minecraft port
enabled = true
filter = minecraft-scanner
port = 25565
backend = systemd
# Conservative initial settings - let fail2ban learn patterns
maxretry = 10
findtime = 600
bantime = 3600
# Use iptables with ipset for efficient IP management
action = iptables-ipset-proto6[name=minecraft-scanners, port=25565, protocol=tcp, bantime=3600]

[minecraft-flood]
# Detects connection flooding attempts
enabled = true
filter = minecraft-flood
port = 25565
backend = systemd
# Higher threshold for flood detection (legitimate players can reconnect)
maxretry = 50
findtime = 60
bantime = 1800
action = iptables-ipset-proto6[name=minecraft-floods, port=25565, protocol=tcp, bantime=1800]

[minecraft-repeat-offender]
# Longer bans for IPs that get banned multiple times
enabled = true
filter = minecraft-scanner
port = 25565
backend = systemd
# Catches repeat offenders with progressive ban times
maxretry = 3
findtime = 86400
bantime = 86400
action = iptables-ipset-proto6[name=minecraft-repeat, port=25565, protocol=tcp, bantime=86400]