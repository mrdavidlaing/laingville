# fail2ban filter for Minecraft connection flooding
# Detects rapid connection attempts that exceed normal player behavior

[INCLUDES]
before = common.conf

[Definition]
# Detect flood patterns:
# 1. Rapid succession of connection attempts (>50 in 1 minute)
# 2. Automated tools making systematic attempts

failregex = ^.*MINECRAFT(-ATTEMPT)?:.*SRC=<HOST>.*DPT=25565.*$

# Ignore local network connections
ignoreregex = SRC=(192\.168\.|10\.|127\.|172\.(1[6-9]|2[0-9]|3[01])\.)

[Init]
# Look at more log lines for flood detection
maxlines = 100

# Additional configuration for flood detection
datepattern = ^%%Y-%%m-%%d %%H:%%M:%%S