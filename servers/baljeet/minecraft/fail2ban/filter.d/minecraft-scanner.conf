# fail2ban filter for Minecraft scanning detection
# Detects SYN-only scanning and other suspicious patterns

[INCLUDES]
before = common.conf

[Definition]
# Detect scanning patterns:
# 1. SYN-only connections (typical port scanners)
# 2. Rate-limited connections (non-Irish IPs hitting limits)
# 3. Multiple rapid connection attempts

failregex = ^.*MINECRAFT(-ATTEMPT)?:.*SRC=<HOST>.*DPT=25565.*SYN.*$
            ^.*MC-RATE-LIMITED:.*SRC=<HOST>.*$
            ^.*MC-BLOCKED:.*SRC=<HOST>.*$

# Ignore local network connections (these are always legitimate)
ignoreregex = SRC=(192\.168\.|10\.|127\.|172\.(1[6-9]|2[0-9]|3[01])\.)

[Init]
# How many seconds to look back for repeated failures
maxlines = 20